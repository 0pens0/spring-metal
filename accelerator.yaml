accelerator:
  displayName: Spring Boot with AI LLM support
  description: The classic TAS demo application, a music catalog written in java/spring, now with AI LLM support!
  iconUrl: https://spring.io/img/projects/spring-cloud.svg
  tags:
  - spring 
  - java 
  - llm 

  options:

  - name: springAI
    dataType: boolean
    inputType: checkbox
    defaultValue: false
    label: Add LLM wiring with Spring AI
  - name: chatCode
    dataType: boolean
    inputType: checkbox
    label: Chat codebase
    dependsOn:
      name: springAI
  - name: textImgCode
    dataType: boolean
    inputType: checkbox
    label: Test-to-Image codebase
    dependsOn:
      name: springAI
  - name: embeddingCode
    dataType: boolean
    inputType: checkbox
    label: Embeddings codebase
    dependsOn:
      name: springAI

  
      
  - name: vectorDB
    label: Vector Database
    inputType: select
    defaultValue: pgvector
    choices:
      - value: memory
        text: In Memory
      - value: pgvector
        text: Tanzu Postgres with pgvector support
      - value: gpdb
        text: Greenplum Database
  
  - name: openAI
    label: Open AI endpoint
    defaultValue: fastchat
    inputType: select
    choices:
      - value: fastchat
        text: Fast Chat
      - value: chatgpt
        text: Chat GPT (public openai)
  

  #deployment type
  - name: appDeploymentType
    label: Deployment environment
    #description: Type of deployment configurations
    defaultValue: tap
    inputType: select
    choices:
    - value: tap
      text: Tanzu Platform for K8s
    - value: cf
      text: Tanzu Platform for VMs
      
engine:
  merge:
    #generic transformation
    - includes: ["**"]
      excludes: [ "config/**", "src/main/java/backend/connectors/**", "config/tap/provision-dev-services.sh"]
      chain:
        - type: ReplaceText
          substitutions:
            - text: APP_NAME
              with: "#artifactId"
            - text: JAVA_VER
              with: "#javaVersion"
            - text: PARENT_APP
              with: "#parentApp"
  
  #deployment configs per type
    - includes: [ "config/tap/*"]
      condition: "#appDeploymentType == 'tap'"
      chain:
        - type: YTT
    - includes: [ "config/cf/**"]
      condition: "#appDeploymentType == 'cf'"
      chain:
        - type: YTT